<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespaceå‘½åç©ºé—´ï¼Œä½œç”¨å°±æ˜¯å¯¹sqlè¿›è¡Œåˆ†ç±»åŒ–ç®¡ç†ï¼Œç†è§£ä¸ºsqléš”ç¦»
æ³¨æ„ï¼šå¦‚æœä½¿ç”¨mapperä»£ç†æ–¹å¼å¼?å‘ï¼Œnamespaceå°±æœ‰é‡è¦çš„ç‰¹æ®Šæ„ä¹‰ã??
 -->
<mapper namespace="test">
  <!-- åœ¨æ˜ å°„æ–‡ä»¶ä¸­å†™sqlè¯­å¥ -->
  <!-- idç”¨äºæ ‡è¯†sqlï¼Œç§°ä¸ºstatementçš„idï¼Œå°†sqlè¯­å¥å°è£…åˆ°mapperStatementå¯¹è±¡ä¸? -->
  
   <select id="findUserById" parameterType="String" resultType="edu.hebeu.po.User">
     <!-- select * from webuser where userid=1 ? #{}è¡¨ç¤ºä¸?ä¸ªç‚¹ä½ç¬¦-->
     <!-- parameterTypeæŒ‡å®šè¾“å…¥å‚æ•°çš„ç±»å‹ï¼Œè¿™é‡ŒæŒ‡å®šStringå‹ï¼Œä¹Ÿå¯æ˜¯intå? 
     #{id}ï¼šidè¡¨ç¤ºæ¥æ”¶è¾“å…¥çš„å‚æ•°ï¼Œæ˜¯è¾“å…¥å‚æ•°åç§°ï¼Œå¦‚æœæ˜¯ç®€å•ç±»å‹ï¼Œåç§°å¯ä»»æ„ï¼Œå¦‚value
     resultTypeï¼šæŒ‡å®šè¾“å‡ºç»“æœçš„ç±»å‹ï¼ŒselectæŒ‡å®šresultTypeè¡¨ç¤ºå°†å•æ¡è®°å½•æ˜ å°„æˆçš„javaå¯¹è±¡
     -->
      select * from webuser where userid=#{id}
    </select>
    <!-- æŒ‰ç…§å§“åæ¨¡ç³ŠæŸ¥è¯¢ ï¼Œå¯èƒ½è¿”å›å¤šæ¡è®°å½?  resultTypeè¡¨ç¤ºçš„å•æ¡è®°å½•ç±»å?-->
    <select id="findUserByName" parameterType="java.lang.String" resultType="edu.hebeu.po.User">
    <!--  select * from webuser where username like '%é¾?%' -->
    <!--  select * from webuser where username like #{value} -->
    <!--${}ï¼šè¡¨ç¤ºæ‹¼æ¥sqlä¸²ï¼Œå°†æ¥æ”¶åˆ°å‚æ•°çš„å†…å®¹ä¸åŠ ä»»ä½•ä¿®é¥°æ‹¼æ¥åˆ°sqlä¸?-->
     select * from webuser where username like '%${value}%' 
     <!-- ${}å­˜åœ¨sqlæ³¨å…¥é—®é¢˜ï¼Œå¦‚æ³¨å…¥ 'or 1=1 or' '%'or 1=1 or'%'  -->
     <!-- ${value}ï¼šæ¥æ”¶è¾“å…¥çš„å‚æ•°ï¼Œå¦‚æœè¾“å…¥å‚æ•°æ˜¯ç®?å•ç±»å‹ï¼Œåªèƒ½ä½¿ç”¨value  -->
    </select>
    
     <!-- æŒ‰ç…§å§“åæ¨¡ç³ŠæŸ¥è¯¢ -->
    <select id="findUserByUserName" parameterType="java.lang.String" resultType="edu.hebeu.po.User">
        select * from webuser where username like concat('%',#{username},'%') 
    </select>
    
     <select id="findUserAll"  resultType="edu.hebeu.po.User">
        select * from webuser  
    </select>
    
    <!-- æŒ‰ç…§å§“åã€å¹´é¾„ç­‰å¤šæ¡ä»¶æŸ¥è¯? -->
    <select id="findUserByNameAndAge" parameterType="edu.hebeu.po.User" resultType="edu.hebeu.po.User">
        select * from webuser where username like concat('%',#{username},'%') and age>=#{age}
    </select>
    <!-- æ·»åŠ ç”¨æˆ· 
    parameterTypeï¼šæŒ‡å®šè¾“å…¥å‚æ•°æ˜¯pojoç±»å‹ï¼ˆåŒ…æ‹¬ç”¨æˆ·ä¿¡æ¯ï¼‰
    #{}ä¸­æŒ‡å®špojoçš„å±æ€§åï¼Œæ¥æ”¶åˆ°pojoçš„å±æ€§å?¼ã?‚mybatisé€šè¿‡ognlè·å–å¯¹è±¡çš„å±æ€§å??
         æ³¨æ„ï¼šsqlç»“å°¾ä¸èƒ½åŠ åˆ†å?;
    idæ˜¯è‡ªå¢å­—æ®µï¼Œä¸ç”¨å†™çš„
    -->
    <insert id="insertUser" parameterType="edu.hebeu.po.User" >
       <!-- 
                 åˆšæ’å…¥æ•°æ®çš„ä¸»é”®è¿”å›ï¼Œè¿”å›è‡³userå¯¹è±¡ä¸?
       select last_insert_id()ï¼šåˆšå¾—åˆ°insertè¿›å»è®°å½•çš„ä¸»é”®å?¼ï¼Œåªé?‚ç”¨äºè‡ªå¢ä¸»é”?
       keyPropertyï¼šå°†æŸ¥è¯¢åˆ°çš„å€¼è®¾å®šåˆ°parameterTypeæŒ‡å®šçš„å¯¹è±¡ä¸­é‚£ä¸ªå±æ??
       orderï¼?  select last_insert_id()çš„æ‰§è¡Œé¡ºåºï¼Œç›¸å¯¹äºinsertçš„æ‰§è¡Œé¡ºåº? 
       resultTypeï¼šæŒ‡å®šæŸ¥è¯¢ç»“æœç±»å?     
        -->
       
       <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            select last_insert_id()
        </selectKey>
        insert into webuser(userid,username,password,age,entrydate) value(#{userid},#{username},#{password},#{age},#{entrydate})
    </insert>
    
     <insert id="insertUser1" parameterType="edu.hebeu.po.User"  >
     <!-- å…ˆé?šè¿‡uuid()æŸ¥è¯¢åˆ°ä¸»é”®ï¼Œå°†ä¸»é”®è¾“å…¥åˆ°sqlè¯­å¥ä¸? -->
        <selectKey keyProperty="id" order="BEFORE" resultType="java.lang.String">
            select uuid()
        </selectKey>
        insert into webuser(id,userid,username,age,entrydate) values(#{id},#{userid},#{username},#{age},#{entrydate})
    </insert>
    
    <delete id="deleteUser" parameterType="java.lang.String">
          delete from webuser where userid=#{userid}
    </delete>
    
    <!-- æŒ‰ç…§useridè¿›è¡Œä¿®æ”¹æ•°æ®ï¼Œéœ€è¦ä¼ å…¥useridå’Œä¿®æ”¹ä¿¡æ¯ï¼Œè¾“å…¥å‚æ•°ä¸ºuserå¯¹è±¡ -->
    <update id="updateUser" parameterType="edu.hebeu.po.User">
        update webuser set username=#{username},password=#{password},age=#{age} where userid=#{userid}
    </update>
    
</mapper>
